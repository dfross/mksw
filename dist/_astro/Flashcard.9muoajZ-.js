import{r,s,t as d,u as f,v as m,w as y,x as w,y as O,z as j,A as X,B as K,C as Y,D as H,E as p}from"./runtime-core.esm-bundler.BCy--UEy.js";const _=(e,t)=>{const i=e.__vccOpts||e;for(const[e,o]of t)i[e]=o;return i},J={name:"ShuffleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Q=["aria-hidden","aria-label"],ee=["fill","width","height"],te={d:"M14.83,13.41L13.42,14.82L16.55,17.95L14.5,20H20V14.5L17.96,16.54L14.83,13.41M14.5,4L16.54,6.04L4,18.59L5.41,20L17.96,7.46L20,9.5V4M10.59,9.17L5.41,4L4,5.41L9.17,10.58L10.59,9.17Z"},ie={key:0};function oe(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon shuffle-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",te,[i.title?(r(),s("title",ie,f(i.title),1)):m("",!0)])],8,ee))],16,Q)}const ne=_(J,[["render",oe]]),re={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},le=["aria-hidden","aria-label"],se=["fill","width","height"],ae={d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},ce={key:0};function de(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon chevron-right-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",ae,[i.title?(r(),s("title",ce,f(i.title),1)):m("",!0)])],8,se))],16,le)}const ue=_(re,[["render",de]]),he={name:"ChevronLeftIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ge=["aria-hidden","aria-label"],fe=["fill","width","height"],me={d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"},ve={key:0};function we(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon chevron-left-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",me,[i.title?(r(),s("title",ve,f(i.title),1)):m("",!0)])],8,fe))],16,ge)}const _e=_(he,[["render",we]]),be={name:"EarHearingIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ce=["aria-hidden","aria-label"],ke=["fill","width","height"],ye={d:"M17,20C16.71,20 16.44,19.94 16.24,19.85C15.53,19.5 15.03,18.97 14.53,17.47C14,15.91 13.06,15.18 12.14,14.47C11.35,13.86 10.53,13.23 9.82,11.94C9.29,11 9,9.93 9,9C9,6.2 11.2,4 14,4C16.8,4 19,6.2 19,9H21C21,5.07 17.93,2 14,2C10.07,2 7,5.07 7,9C7,10.26 7.38,11.65 8.07,12.9C9,14.55 10.05,15.38 10.92,16.05C11.73,16.67 12.31,17.12 12.63,18.1C13.23,19.92 14,20.94 15.36,21.65C15.87,21.88 16.43,22 17,22A4,4 0 0,0 21,18H19A2,2 0 0,1 17,20M7.64,2.64L6.22,1.22C4.23,3.21 3,5.96 3,9C3,12.04 4.23,14.79 6.22,16.78L7.63,15.37C6,13.74 5,11.5 5,9C5,6.5 6,4.26 7.64,2.64M11.5,9A2.5,2.5 0 0,0 14,11.5A2.5,2.5 0 0,0 16.5,9A2.5,2.5 0 0,0 14,6.5A2.5,2.5 0 0,0 11.5,9Z"},pe={key:0};function Le(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon ear-hearing-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",ye,[i.title?(r(),s("title",pe,f(i.title),1)):m("",!0)])],8,ke))],16,Ce)}const xe=_(be,[["render",Le]]),Se={name:"MicrophoneIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ae=["aria-hidden","aria-label"],Ie=["fill","width","height"],Me={d:"M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"},ze={key:0};function Ee(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon microphone-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",Me,[i.title?(r(),s("title",ze,f(i.title),1)):m("",!0)])],8,Ie))],16,Ae)}const We=_(Se,[["render",Ee]]),Ne={name:"CheckboxMarkedCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Pe=["aria-hidden","aria-label"],Be=["fill","width","height"],Re={d:"M10,17L5,12L6.41,10.58L10,14.17L17.59,6.58L19,8M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},He={key:0};function Te(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon checkbox-marked-circle-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",Re,[i.title?(r(),s("title",He,f(i.title),1)):m("",!0)])],8,Be))],16,Pe)}const $e=_(Ne,[["render",Te]]),Fe={name:"AlphaXCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ve=["aria-hidden","aria-label"],Ue=["fill","width","height"],De={d:"M9,7L11,12L9,17H11L12,14.5L13,17H15L13,12L15,7H13L12,9.5L11,7H9M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z"},Ze={key:0};function qe(e,t,i,o,n,l){return r(),s("span",y(e.$attrs,{"aria-hidden":!i.title||null,"aria-label":i.title,class:"material-design-icon alpha-x-circle-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[(r(),s("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[d("path",De,[i.title?(r(),s("title",Ze,f(i.title),1)):m("",!0)])],8,Ue))],16,Ve)}const Oe=_(Fe,[["render",qe]]),je={__name:"Flashcard",props:{words:{type:Array,required:!0},set:{type:String,required:!0}},emits:["wordChanged"],setup(e,{expose:t,emit:i}){t();const o=e,r=i,n=w(0),l=w(!1),a=w(!1),s=w(!1),c=w(!1),d=w(!1),u=w("");let h,g,p,m=null;const v=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});d.value=!0,e.getTracks().forEach((e=>e.stop()))}catch(e){console.error("Microphone permissions not granted:",e),d.value=!1,u.value="Microphone access is required for voice recognition."}},f=()=>{if(c.value){const e=window.SpeechRecognition||window.webkitSpeechRecognition;h=new e,h.continuous=!1,h.interimResults=!1,h.onresult=e=>{console.log("Speech recognition result received");const t=e.results.length-1,i=e.results[t][0].transcript.trim().toLowerCase(),r=o.words[n.value].toLowerCase();u.value=i===r?"Correct! Well done!":`Not quite. The word is "${r}". You said "${i}".`,a.value=!1,z()},h.onerror=e=>{switch(console.error("Speech recognition error:",e.error),a.value=!1,e.error){case"no-speech":u.value="No speech detected. Please try again.";break;case"audio-capture":u.value="Please ensure your microphone is not blocked and try again.";break;case"not-allowed":u.value="Microphone access has been denied. Check your browser settings.";break;case"service-not-allowed":u.value="The microphone service is not allowed. Check your permissions.";break;default:u.value="Sorry, I couldn't hear you. Please try again."}z()},h.onend=()=>{console.log("Speech recognition ended"),a.value=!1,z()}}else u.value="Speech recognition is not supported in your browser."},b=()=>{if(console.log("Force stopping all audio"),window.AudioContext||window.webkitAudioContext){const e=window.AudioContext||window.webkitAudioContext,t=[];for(;e.getContexts&&e.getContexts().length;)t.push(e.getContexts()[0]);t.forEach((e=>{"closed"!==e.state&&e.close()}))}navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{e.getTracks().forEach((e=>e.stop()))})).catch((e=>console.error("Error accessing media devices.",e))),h&&h.abort(),a.value=!1,m=null},C=()=>{console.log("Cleanup function called"),b(),p&&clearTimeout(p)},y=()=>{(document.hidden||"hidden"===document.visibilityState)&&(console.log("Page visibility changed to hidden"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream?b():C())},k=()=>{console.log("Window blur event triggered"),C()},L=()=>{console.log("Page hide event triggered"),C(),h&&h.stop()},x=()=>{console.log("Before unload event triggered"),b()};O((async()=>{s.value="speechSynthesis"in window,c.value="SpeechRecognition"in window||"webkitSpeechRecognition"in window,v(),f(),window.addEventListener("keydown",I),window.addEventListener("setFlashcardWord",_),document.addEventListener("visibilitychange",y),window.addEventListener("blur",k),window.addEventListener("pagehide",L),window.addEventListener("beforeunload",x),g=setInterval((()=>{document.hasFocus()||C()}),1e3)})),j((()=>{window.removeEventListener("keydown",I),window.removeEventListener("setFlashcardWord",_),document.removeEventListener("visibilitychange",y),window.removeEventListener("blur",k),window.removeEventListener("pagehide",L),window.removeEventListener("beforeunload",x),clearInterval(g),C()})),X(n,(e=>{u.value="",r("wordChanged",e),z()}));const S=()=>{n.value<o.words.length-1&&n.value++},A=()=>{n.value>0&&n.value--},M=()=>{const e=Math.floor(Math.random()*o.words.length);n.value=e},I=e=>{"ArrowRight"===e.key||"Space"===e.code?S():"ArrowLeft"===e.key?A():("r"===e.key||"R"===e.key)&&M()},_=e=>{const t=e.detail.index;t>=0&&t<o.words.length&&(n.value=t)},z=()=>{console.log("Stopping microphone"),m&&(m.getTracks().forEach((e=>{e.stop()})),m=null),a.value=!1},E={props:o,emit:r,currentIndex:n,isSpeaking:l,isListening:a,speechSupported:s,recognitionSupported:c,microphoneAvailable:d,feedback:u,get recognition(){return h},set recognition(e){h=e},get microphoneStream(){return m},set microphoneStream(e){m=e},get cleanupInterval(){return g},set cleanupInterval(e){g=e},get listenTimeout(){return p},set listenTimeout(e){p=e},checkMicrophonePermissions:v,initializeSpeechRecognition:f,forceStopAudio:b,cleanup:C,handleVisibilityChange:y,handleWindowBlur:k,handlePageHide:L,handleBeforeUnload:x,nextWord:S,previousWord:A,selectRandomWord:M,handleKeydown:I,handleSetFlashcardWord:_,speakWord:()=>{if(!s.value)return void(u.value="Speech synthesis is not supported in your browser.");const e=o.words[n.value].trim();l.value&&window.speechSynthesis.cancel(),l.value=!0;const t=new SpeechSynthesisUtterance(e);t.rate=.8,t.pitch=1,1===e.length&&"i"===e.toLowerCase()?t.text=`- ${e}`:t.text=e,t.onend=()=>{l.value=!1},t.onerror=e=>{console.error("SpeechSynthesis error:",e),l.value=!1,u.value="An error occurred while trying to speak the word."},window.speechSynthesis.speak(t)},stopMicrophone:z,listenForWord:async()=>{if(console.log("Attempting to listen for word..."),c.value)try{b();new(window.AudioContext||window.webkitAudioContext);m=await navigator.mediaDevices.getUserMedia({audio:!0}),u.value="",a.value=!0,h.start(),p=setTimeout((()=>{a.value&&(C(),u.value="Listening timed out. Please try again.")}),1e4)}catch(e){console.error("Error accessing microphone:",e),u.value="Unable to access the microphone. Please check your microphone settings and try again."}else u.value="Speech recognition is not supported in your browser."},ref:w,onMounted:O,onUnmounted:j,watch:X,ShuffleIcon:ne,ChevronRightIcon:ue,ChevronLeftIcon:_e,EarHearingIcon:xe,MicrophoneIcon:We,CheckboxMarkedCircleIcon:$e,AlphaXCircleIcon:Oe};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}},Xe={class:"flex flex-col items-center pt-9"},Ke={class:"relative mb-9 flex h-[30vh] w-full items-center justify-center rounded-lg bg-gradient-to-b from-cyan-100 to-blue-100 text-blue-900 shadow-2xl sm:h-[50vh] sm:max-h-[500px]",role:"region","aria-label":"Flashcard"},Ye={class:"text-7xl font-medium drop-shadow-md md:text-9xl","aria-live":"polite"},Ge={class:"absolute bottom-3 right-3","aria-live":"polite"},Je={key:1,class:"absolute right-3 top-3"},Qe={class:"flex w-full flex-col items-center justify-between gap-2 sm:flex-row"},et={class:"flex gap-2"},tt=["disabled"],it=["disabled"],ot={class:"flex gap-2"},nt=["disabled"],rt=["disabled"];function lt(e,t,i,o,n,l){return r(),s("div",Xe,[d("div",Ke,[d("h2",Ye,f(i.words[o.currentIndex]),1),o.feedback?(r(),s("div",{key:0,class:K(["absolute bottom-3 flex items-center gap-1 rounded-full border px-4 py-2 text-lg font-semibold",{"border-green-300 bg-green-100 text-green-700":o.feedback.includes("Correct"),"border-red-300 bg-red-200 text-red-800":o.feedback.includes("Not quite")}])},[o.feedback.includes("Correct")?(r(),Y(o.CheckboxMarkedCircleIcon,{key:0,size:24,class:"mr-2 text-green-700"})):m("",!0),o.feedback.includes("Not quite")?(r(),Y(o.AlphaXCircleIcon,{key:1,size:24,class:"mr-2 text-red-700"})):m("",!0),H(" "+f(o.feedback),1)],2)):m("",!0),d("small",Ge,f(o.currentIndex+1)+"/"+f(i.words.length),1),o.isListening?(r(),s("div",Je,[p(o.MicrophoneIcon,{class:K({"animate-pulse":o.isListening})},null,8,["class"])])):m("",!0)]),d("div",Qe,[d("div",et,[d("button",{class:"button button-iconleft",onClick:o.previousWord,disabled:0===o.currentIndex,"aria-label":"Previous word"},[p(o.ChevronLeftIcon),t[0]||(t[0]=H(" Prev "))],8,tt),d("button",{class:"button button-icon",onClick:o.selectRandomWord,"aria-label":"Random word"},[p(o.ShuffleIcon)]),d("button",{class:"button button-iconright",onClick:o.nextWord,disabled:o.currentIndex===i.words.length-1,"aria-label":"Next word"},[t[1]||(t[1]=H(" Next ")),p(o.ChevronRightIcon)],8,it)]),d("div",ot,[d("button",{class:"button button-icon",onClick:o.speakWord,disabled:!o.speechSupported,"aria-label":"Speak word"},[p(o.EarHearingIcon)],8,nt),d("button",{class:"button button-icon",onClick:o.listenForWord,disabled:!o.microphoneAvailable,"aria-label":"Listen for word"},[p(o.MicrophoneIcon)],8,rt)])])])}const ct=_(je,[["render",lt]]);export{ct as default};